---
title: "Experiment design"
bibliography: bib.bib
link-citations: yes
---

The experiment of assessing different network inference methods can be split into two folds: species abundance time-series simulation and solving and evaluating the network.

## Simulation methods

The generalized Lotka-Volterra (gLV) model is the most widely used method for simulating a microbial community. MiSDEED [@Chlenski_Hsu_Peer_2022] is a Python package based on gLV, in addition to regular gLV simulations, it also considers the environmental perturbations/interventions. After the absolute abundance of species $\textbf{Z}$ is generated, MiSDEED also calculates the relative abundance $\textbf{Y}$, and finally samples the observed relative abundance $\textbf{X}$ to simulate the read sampling.

In the gLV simulation, there are multiple adjustable parameters, including the growth rate $g$, the interaction matrix $\textbf{M}$ and the perturbation over time.
Among these parameters, the adjacency matrix $\textbf{A}$ determines the structure of the network, and the weight matrix $\textbf{M}$ determines the interaction between two species where $\textbf{M}_{ij}$ indicates the effect of species $i$ to species $j$.

As the parameter of the generated network, suppose there are $n$ species in the network, and the average degree of the network is $\langle k \rangle = \frac{2m}{n}$, where $m$ is the total number of edges in the network.

Different models were proposed to generate the adjacency matrix $\textbf{A}$, the most straightforward way is to generate a random network, where two nodes are connected with a probability $p$.
However, the random network is not a good representation of the real microbial community; the real network usually has two properties: small-world and scale-free.

- Random network

    This type of network is homogeneous in most properties and has no special structure.
    However, networks in real life exhibit a variety of structures, and the random network is not a good representation of the real microbial community.

- Small-world network

    When taxon $i$ is connected to both taxon $j$ and taxon $k$, there is a higher probability that taxon $j$ and taxon $k$ are connected too.
    This type of network can be generated with the Watts-Strogatz model [@Watts_Strogatz_1998].

- Scale-free network

    In real complex network it is very likely that a small number of nodes, called "hubs", have a large number of connections, while most nodes have only a few connections.
    The distribution of the number of connections of the nodes in the network follows a power law.
    This type of network can be generated with the Chung-Lu model [@Chung_Lu_2002].

## Network inference methods

The network inference methods currently used are listed below.

<!-- [to fill different methods]{style="color: red"} -->
- Pearson

- Pearson partial

- SparCC

- SPIEC-EASI

- Compositional Lotka-Volterra (cLV)

    The compositional Lotka-Volterra (cLV) model [@Joseph_Shenhav_Xavier_Halperin_Peer_2020] is a model that can be used to infer the network structure from the relative abundance data.

## Preliminary results

### Comparison between naive gLV model and MiSDEED

In the analysis of [@Hirano_Takemoto_2019], the authors used the naive gLV model to generate the network, whilst the MiSDEED package was able to generate more realistic simulation by considering reads sampling, random noises and environmental perturbations.
One natural question arises is that whether the evaluation results in [@Hirano_Takemoto_2019] holds for networks generated by MiSDEED.

As a preliminary test, we set the number of taxa in the network to be $n = 20$, and the average degree of the network to be $\langle k \rangle = 2$.
The network structure was set to random network.
The tested results are Pearson's correlation, Pearson's partial correlation, SparCC, and SPIEC-EASI.
The performance of different methods are evaluated using PR-AUC, which is the area under the precision-recall curve, and the result is shown in the following table.


|                 | naive     | MiSDEED    |
|-----------------|-----------|------------|
| Pearson         | 0.6833395 | 0.07341247 |
| Pearson partial | 0.6766284 | 0.08995016 |
| SparCC          | 0.6300331 | 0.1027987  |
| SPIEC-EASI      | 0.7314267 | 0.09747966 |

The result shows that the performance of different methods on data generated by the naive gLV model is much better than data generated by MiSDEED, which invalidates nearly all the practical uses of the current available methods.

# References